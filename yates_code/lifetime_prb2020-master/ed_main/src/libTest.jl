#=
Test functions will go here.
=#


# This function returns the Hamiltonian for
# L = 4, written out explicitly.
# alpha is for the boundary condition
function smallH(Jx,g,Jz,alpha = 0.0)
    hxx = Jx.*[
        0.0  0.0  0.0  1.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0;
        0.0  0.0  1.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0;
        0.0  1.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0;
        1.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0;
        0.0  0.0  1.0  0.0  0.0  0.0  0.0  1.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0;
        0.0  0.0  0.0  1.0  0.0  0.0  1.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0;
        1.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0;
        0.0  1.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0;
        0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  1.0  0.0;
        0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  1.0;
        0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  1.0  0.0  0.0  1.0  0.0  0.0  0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  1.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0;
        1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  1.0;
        0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  1.0  0.0;
        0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0;
        0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  1.0  0.0  0.0  0.0]
    hz = g .* [
        4.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0  0.0  0.0  0.0   0.0  0.0   0.0   0.0   0.0;
        0.0  2.0  0.0  0.0  0.0  0.0  0.0   0.0  0.0  0.0  0.0   0.0  0.0   0.0   0.0   0.0;
        0.0  0.0  2.0  0.0  0.0  0.0  0.0   0.0  0.0  0.0  0.0   0.0  0.0   0.0   0.0   0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0  0.0  0.0  0.0   0.0  0.0   0.0   0.0   0.0;
        0.0  0.0  0.0  0.0  2.0  0.0  0.0   0.0  0.0  0.0  0.0   0.0  0.0   0.0   0.0   0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0  0.0  0.0  0.0   0.0  0.0   0.0   0.0   0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0  0.0  0.0  0.0   0.0  0.0   0.0   0.0   0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0  -2.0  0.0  0.0  0.0   0.0  0.0   0.0   0.0   0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0  2.0  0.0  0.0   0.0  0.0   0.0   0.0   0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0  0.0  0.0  0.0   0.0  0.0   0.0   0.0   0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0  0.0  0.0  0.0   0.0  0.0   0.0   0.0   0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0  0.0  0.0  0.0  -2.0  0.0   0.0   0.0   0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0  0.0  0.0  0.0   0.0  0.0   0.0   0.0   0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0  0.0  0.0  0.0   0.0  0.0  -2.0   0.0   0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0  0.0  0.0  0.0   0.0  0.0   0.0  -2.0   0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0   0.0  0.0  0.0  0.0   0.0  0.0   0.0   0.0  -4.0]
    hzz = Jz .* [
        3.0  0.0   0.0  0.0   0.0   0.0   0.0  0.0  0.0   0.0   0.0   0.0  0.0   0.0  0.0  0.0;
        0.0  1.0   0.0  0.0   0.0   0.0   0.0  0.0  0.0   0.0   0.0   0.0  0.0   0.0  0.0  0.0;
        0.0  0.0  -1.0  0.0   0.0   0.0   0.0  0.0  0.0   0.0   0.0   0.0  0.0   0.0  0.0  0.0;
        0.0  0.0   0.0  1.0   0.0   0.0   0.0  0.0  0.0   0.0   0.0   0.0  0.0   0.0  0.0  0.0;
        0.0  0.0   0.0  0.0  -1.0   0.0   0.0  0.0  0.0   0.0   0.0   0.0  0.0   0.0  0.0  0.0;
        0.0  0.0   0.0  0.0   0.0  -3.0   0.0  0.0  0.0   0.0   0.0   0.0  0.0   0.0  0.0  0.0;
        0.0  0.0   0.0  0.0   0.0   0.0  -1.0  0.0  0.0   0.0   0.0   0.0  0.0   0.0  0.0  0.0;
        0.0  0.0   0.0  0.0   0.0   0.0   0.0  1.0  0.0   0.0   0.0   0.0  0.0   0.0  0.0  0.0;
        0.0  0.0   0.0  0.0   0.0   0.0   0.0  0.0  1.0   0.0   0.0   0.0  0.0   0.0  0.0  0.0;
        0.0  0.0   0.0  0.0   0.0   0.0   0.0  0.0  0.0  -1.0   0.0   0.0  0.0   0.0  0.0  0.0;
        0.0  0.0   0.0  0.0   0.0   0.0   0.0  0.0  0.0   0.0  -3.0   0.0  0.0   0.0  0.0  0.0;
        0.0  0.0   0.0  0.0   0.0   0.0   0.0  0.0  0.0   0.0   0.0  -1.0  0.0   0.0  0.0  0.0;
        0.0  0.0   0.0  0.0   0.0   0.0   0.0  0.0  0.0   0.0   0.0   0.0  1.0   0.0  0.0  0.0;
        0.0  0.0   0.0  0.0   0.0   0.0   0.0  0.0  0.0   0.0   0.0   0.0  0.0  -1.0  0.0  0.0;
        0.0  0.0   0.0  0.0   0.0   0.0   0.0  0.0  0.0   0.0   0.0   0.0  0.0   0.0  1.0  0.0;
        0.0  0.0   0.0  0.0   0.0   0.0   0.0  0.0  0.0   0.0   0.0   0.0  0.0   0.0  0.0  3.0]
    hxxP = alpha*Jx .*[
        0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0;
        0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0;
        1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0;
        0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0;
        0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0;
        0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0;
        0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0;
        0.0  0.0  0.0  0.0  0.0  0.0  1.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0]
    hzzP = alpha*Jz .*[
        1.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0  0.0;
        0.0  -1.0  0.0   0.0  0.0   0.0  0.0   0.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0  0.0;
        0.0   0.0  1.0   0.0  0.0   0.0  0.0   0.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0  0.0;
        0.0   0.0  0.0  -1.0  0.0   0.0  0.0   0.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0  0.0;
        0.0   0.0  0.0   0.0  1.0   0.0  0.0   0.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0  0.0;
        0.0   0.0  0.0   0.0  0.0  -1.0  0.0   0.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0  0.0;
        0.0   0.0  0.0   0.0  0.0   0.0  1.0   0.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0  0.0;
        0.0   0.0  0.0   0.0  0.0   0.0  0.0  -1.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0  0.0;
        0.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0  -1.0  0.0   0.0  0.0   0.0  0.0   0.0  0.0;
        0.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0   0.0  1.0   0.0  0.0   0.0  0.0   0.0  0.0;
        0.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0   0.0  0.0  -1.0  0.0   0.0  0.0   0.0  0.0;
        0.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0   0.0  0.0   0.0  1.0   0.0  0.0   0.0  0.0;
        0.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0   0.0  0.0   0.0  0.0  -1.0  0.0   0.0  0.0;
        0.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0   0.0  0.0   0.0  0.0   0.0  1.0   0.0  0.0;
        0.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0   0.0  0.0   0.0  0.0   0.0  0.0  -1.0  0.0;
        0.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0   0.0  0.0   0.0  0.0   0.0  0.0   0.0  1.0]
    return hxx + hz + hzz + hxxP + hzzP
end

